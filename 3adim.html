<!DOCTYPE html>
<html lang="tr" data-theme="light">
  
<head>
  <link rel="icon" href="/img/favicon.ico" type="image/x-icon">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>TYT Optik Form</title>
  <!-- Tom Select CSS -->
<link href="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/css/tom-select.css" rel="stylesheet">

<!-- Tom Select JS -->
<script src="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/js/tom-select.complete.min.js"></script>

<!-- Font Awesome for icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    :root {
      --bg-color: #f4f4f4;
      --container-bg: #fff;
      --text-color: #333;
      --border-color: #ccc;
      --primary-color: #007bff;
      --secondary-bg: #f8f9fa;
      --secondary-text: #6c757d;
      --question-bg: #a8d5ba;
      --header-underline: #ddd;
      --shadow-color: rgba(0,0,0,0.1);
      --ts-background: #fff;
      --ts-text: #333;
      --turkce-color: #00c3ff;
      --sosyal-color: #fd9644;
      --mat-color: #4cd137;
      --fen-color: #9c88ff;
    }

    [data-theme="dark"] {
      --bg-color: #222;
      --container-bg: #333;
      --text-color: #eee;
      --border-color: #555;
      --primary-color: #0d6efd;
      --secondary-bg: #444;
      --secondary-text: #bbb;
      --question-bg: #4a7a5e;
      --header-underline: #555;
      --shadow-color: rgba(0,0,0,0.25);
      --ts-background: #444;
      --ts-text: #eee;
    }

    body {
      font-family: 'Segoe UI', sans-serif;
      background: var(--bg-color);
      padding: 20px;
      color: var(--text-color);
      transition: background 0.3s ease, color 0.3s ease;
    }

    .container {
      max-width: 1000px;
      margin: auto;
      background: var(--container-bg);
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 0 15px var(--shadow-color);
      transition: background 0.3s ease, box-shadow 0.3s ease;
    }

    h2 {
      text-align: center;
      margin-bottom: 20px;
      color: var(--text-color);
      padding-bottom: 10px;
      border-bottom: 1px solid var(--header-underline);
    }

    select {
      padding: 10px;
      font-size: 16px;
      border-radius: 8px;
      border: 1px solid var(--border-color);
      width: 100%;
      margin-bottom: 20px;
      background-color: var(--container-bg);
      color: var(--text-color);
    }

    .select-group {
      display: flex;
      gap: 15px;
      margin-bottom: 20px;
    }

    .select-group > div {
      flex: 1;
    }

    .question-row {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
    }

    .question-number {
      width: 35px;
      height: 35px;
      background-color: var(--question-bg);
      color: #fff;
      border-radius: 5px;
      text-align: center;
      line-height: 35px;
      font-weight: bold;
      margin-right: 10px;
    }

    .options {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .options input[type="radio"]:checked.wrong + label {
  background-color: #dc3545 !important; /* Red for wrong answers */
  border-color: #dc3545 !important;
  color: white;
}

.options input[type="radio"]:checked.correct + label {
  background-color: #28a745 !important; /* Green for correct answers */
  border-color: #28a745 !important;
  color: white;
}
    .options input[type="radio"] {
      display: none;
    }

    .options label {
      display: inline-block;
      width: 35px;
      height: 35px;
      border: 2px solid var(--border-color);
      border-radius: 50%;
      line-height: 35px;
      text-align: center;
      cursor: pointer;
      transition: all 0.2s ease;
      background-color: var(--container-bg);
      color: var(--text-color);
    }

    .options input[type="radio"]:checked + label {
      background-color: var(--primary-color);
      color: white;
      border-color: var(--primary-color);
    }

.options input[type="radio"]:checked.wrong + label {
  background-color: #dc3545 !important;
  border-color: #dc3545 !important;
  color: white;
}

.options input[type="radio"]:checked.correct + label {
  background-color: #28a745 !important;
  border-color: #28a745 !important;
  color: white;
}

.correct-answer {
  background-color: #ffc107 !important;
  border-color: #ffc107 !important;
  color: black !important;
}

    .submit-btn {
      background-color: #4CAF50;
      color: white;
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      width: 100%;
      margin-top: 20px;
      cursor: pointer;
      transition: 0.3s;
    }

    .submit-btn:hover {
      background-color: #45a049;
    }

    .result {
      margin-top: 20px;
      font-size: 16px;
    }

    .result table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }

    .result th, .result td {
      border: 1px solid var(--border-color);
      padding: 10px;
      text-align: center;
    }
    
    .feedback-text {
      margin-top: 15px;
      padding: 15px;
      border-radius: 8px;
      text-align: center;
      font-weight: 500;
      font-style: italic;
    }
    
    .feedback-poor {
      background-color: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
    
    .feedback-fair {
      background-color: #fff3cd;
      color: #856404;
      border: 1px solid #ffeeba;
    }
    
    .feedback-good {
      background-color: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }
    
    .feedback-excellent {
      background-color: #cce5ff;
      color: #004085;
      border: 1px solid #b8daff;
    }

    .whatsapp-share-btn {
      background-color: #25D366;
      color: white;
      padding: 10px 15px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      margin: 15px auto;
      transition: all 0.3s ease;
    }

    .whatsapp-share-btn:hover {
      background-color: #128C7E;
    }

    .whatsapp-share-container {
      text-align: center;
      margin-top: 15px;
    }

    .dark-mode-toggle {
      position: absolute;
      top: 20px;
      right: 20px;
      font-size: 24px;
      cursor: pointer;
      color: var(--text-color);
      background: none;
      border: none;
      transition: transform 0.3s ease;
      z-index: 10;
    }

    .dark-mode-toggle:hover {
      transform: scale(1.1);
    }

    .dark-mode .ts-control {
      background-color: var(--ts-background);
      color: var(--ts-text);
      border-color: var(--border-color);
    }

    .dark-mode .ts-dropdown {
      background-color: var(--ts-background);
      color: var(--ts-text);
      border-color: var(--border-color);
    }

    .dark-mode .ts-dropdown .option {
      color: var(--ts-text);
    }

    .dark-mode .ts-dropdown .active {
      background-color: var(--primary-color);
      color: #fff;
    }

    .difficulty-container {
      margin: 20px 0;
      padding: 15px;
      background-color: var(--secondary-bg);
      border-radius: 8px;
      box-shadow: 0 2px 5px var(--shadow-color);
    }

    .difficulty-label {
      display: flex;
      justify-content: space-between;
      margin-bottom: 5px;
      font-weight: 500;
    }

    .difficulty-rating {
      height: 10px;
      background: linear-gradient(to right, #28a745, #ffc107, #dc3545);
      border-radius: 10px;
      position: relative;
      overflow: hidden;
    }

    .difficulty-marker {
      width: 4px;
      height: 14px;
      background-color: #000;
      position: absolute;
      top: -2px;
      transform: translateX(-50%);
      border-radius: 2px;
      box-shadow: 0 0 3px rgba(0,0,0,0.5);
    }

    .difficulty-steps {
      display: flex;
      justify-content: space-between;
      padding: 0 5px;
      margin-top: 5px;
      font-size: 12px;
      color: var(--secondary-text);
    }

    /* Tabs for TYT subjects */
    .tabs-container {
      margin: 20px 0;
    }

    .tabs {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 20px;
    }

    .tab {
      padding: 12px 20px;
      border-radius: 8px;
      cursor: pointer;
      text-align: center;
      font-weight: 600;
      transition: all 0.3s ease;
      flex: 1;
      min-width: 120px;
    }

    .tab-turkce {
      background-color: rgba(0, 195, 255, 0.2);
      color: #00c3ff;
      border: 2px solid #00c3ff;
    }

    .tab-turkce.active {
      background-color: #00c3ff;
      color: white;
    }

    .tab-sosyal {
      background-color: rgba(253, 150, 68, 0.2);
      color: #fd9644;
      border: 2px solid #fd9644;
    }

    .tab-sosyal.active {
      background-color: #fd9644;
      color: white;
    }

    .tab-matematik {
      background-color: rgba(76, 209, 55, 0.2);
      color: #4cd137;
      border: 2px solid #4cd137;
    }

    .tab-matematik.active {
      background-color: #4cd137;
      color: white;
    }

    .tab-fen {
      background-color: rgba(156, 136, 255, 0.2);
      color: #9c88ff;
      border: 2px solid #9c88ff;
    }

    .tab-fen.active {
      background-color: #9c88ff;
      color: white;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    .exam-sections {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
    }

    .exam-section {
      flex: 1;
      min-width: 200px;
      border-radius: 10px;
      padding: 10px;
      box-shadow: 0 2px 5px var(--shadow-color);
    }

    .turkce-section {
      border: 2px solid var(--turkce-color);
    }

    .sosyal-section {
      border: 2px solid var(--sosyal-color);
    }

    .mat-section {
      border: 2px solid var(--mat-color);
    }

    .fen-section {
      border: 2px solid var(--fen-color);
    }

    .section-title {
      text-align: center;
      padding: 5px;
      border-radius: 5px;
      margin-bottom: 10px;
      font-weight: bold;
    }

    .turkce-title {
      background-color: var(--turkce-color);
      color: white;
    }

    .sosyal-title {
      background-color: var(--sosyal-color);
      color: white;
    }

    .mat-title {
      background-color: var(--mat-color);
      color: white;
    }

    .fen-title {
      background-color: var(--fen-color);
      color: white;
    }

 .option-grid {
  display: grid;
  grid-template-rows: repeat(10, auto);
  grid-auto-flow: column;
  gap: 5px;
  overflow-x: auto;
  padding-bottom: 10px;
}

    .option-row {
      display: flex;
      align-items: center;
      margin-bottom: 8px;
    }

    .option-num {
      width: 25px;
      text-align: right;
      margin-right: 8px;
      font-weight: bold;
    }

    .option-checkbox {
      display: flex;
      justify-content: space-between;
      flex-grow: 1;
    }

    .option-label {
      display: inline-block;
      width: 28px;
      height: 28px;
      border: 1.5px solid var(--border-color);
      border-radius: 50%;
      line-height: 28px;
      text-align: center;
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 14px;
    }

    .option-input {
      display: none;
    }

    .option-input:checked + .option-label {
      background-color: var(--primary-color);
      color: white;
      border-color: var(--primary-color);
    }

    .turkce-section .option-input:checked + .option-label {
      background-color: var(--turkce-color);
      border-color: var(--turkce-color);
    }

    .sosyal-section .option-input:checked + .option-label {
      background-color: var(--sosyal-color);
      border-color: var(--sosyal-color);
    }

    .mat-section .option-input:checked + .option-label {
      background-color: var(--mat-color);
      border-color: var(--mat-color);
    }

    .fen-section .option-input:checked + .option-label {
      background-color: var(--fen-color);
      border-color: var(--fen-color);
    }

    /* Marking for correct and wrong answers */
    .option-input.correct-user:checked + .option-label {
      background-color: #28a745 !important;
      border-color: #28a745 !important;
    }

    .option-input.wrong:checked + .option-label {
      background-color: #dc3545 !important;
      border-color: #dc3545 !important;
    }

    .correct-answer {
      background-color: #ffc107 !important;
      border-color: #ffc107 !important;
      color: black !important;
    }

    @media (max-width: 768px) {
      .exam-sections {
        flex-direction: column;
      }
      
      .tabs {
        flex-direction: column;
      }
      
      .select-group {
        flex-direction: column;
      }
      
      .dark-mode-toggle {
        top: 10px;
        right: 10px;
      }

  .option-grid {
    padding-bottom: 20px; /* Extra padding for scrollbar */
    -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
  }
}
    


  </style>
</head>
<body>
  <button id="darkModeToggle" class="dark-mode-toggle" onclick="toggleDarkMode()">
    <i class="fas fa-moon"></i>
  </button>

  <div class="container">
    <div style="text-align: center; margin-bottom: 20px;">
      <a href="index.html">
        <img src="/img/logoBf.png" alt="Site Logo" style="max-width: 150px; height: auto;">
      </a>
    </div>
    <h2>TYT Optik Form</h2>
    <div style="background-color: var(--secondary-bg); color: var(--secondary-text); padding: 15px; border-radius: 8px; text-align: center; margin-bottom: 20px; font-size: 14px; box-shadow: 0 2px 5px var(--shadow-color);">
      Bu form, TYT deneme sınavlarınızı kontrol etmek için kullanılmaktadır. Lütfen sınav serisini ve deneme numarasını seçip cevaplarınızı işaretleyin.
    </div>

    <div style="background-color: var(--secondary-bg); color: var(--secondary-text); padding: 15px; border-radius: 8px; text-align: center; margin-bottom: 20px; font-size: 14px; box-shadow: 0 2px 5px var(--shadow-color);">
    <em>"Anlamak istemeyene hiçbir şey öğretemem ben."</em> <br> <strong><em>Konfüçyüs</em></strong>
    </div>
    
    <div class="select-group">
      <div>
        <select id="seriesType">
          <option value="">*Seri Seçin</option>
          <option value="ucadimbir">3 Adım, 1. Adım</option>
          <option value="ucadimiki">3 Adım, 2. Adım</option>
          <option value="ucadimuc">3 Adım, 3. Adım</option>
        </select>
      </div>
      <div>
        <select id="examType" disabled>
          <option value="">*Deneme Seçin</option>
        </select>
      </div>
    </div>

    <!-- Difficulty Rating Bar -->
    <div id="difficultyContainer" class="difficulty-container" style="display: none;">
      <div class="difficulty-label">
        <span>Zorluk Seviyesi</span>
        <span id="difficultyText">Orta</span>
      </div>
      <div class="difficulty-rating">
        <div id="difficultyMarker" class="difficulty-marker"></div>
      </div>
      <div class="difficulty-steps">
        <span>Kolay</span>
        <span>Orta</span>
        <span>Zor</span>
      </div>
    </div>

    <!-- Tabs for Subject Selection -->
    <div class="tabs-container">
      <div class="tabs">
        <div class="tab tab-turkce active" data-tab="turkce">Türkçe</div>
        <div class="tab tab-sosyal" data-tab="sosyal">Sosyal Bilimler</div>
        <div class="tab tab-matematik" data-tab="matematik">Temel Matematik</div>
        <div class="tab tab-fen" data-tab="fen">Fen Bilimleri</div>
      </div>

      <!-- Tab Content -->
      <div id="turkceContent" class="tab-content active">
        <div class="exam-section turkce-section">
          <div class="section-title turkce-title">Türkçe</div>
          <div id="turkceForm" class="option-grid"></div>
        </div>
      </div>

      <div id="sosyalContent" class="tab-content">
        <div class="exam-section sosyal-section">
          <div class="section-title sosyal-title">Sosyal Bilimler</div>
          <div id="sosyalForm" class="option-grid"></div>
        </div>
      </div>

      <div id="matematikContent" class="tab-content">
        <div class="exam-section mat-section">
          <div class="section-title mat-title">Temel Matematik</div>
          <div id="matematikForm" class="option-grid"></div>
        </div>
      </div>

      <div id="fenContent" class="tab-content">
        <div class="exam-section fen-section">
          <div class="section-title fen-title">Fen Bilimleri</div>
          <div id="fenForm" class="option-grid"></div>
        </div>
      </div>
    </div>

    <button class="submit-btn" onclick="confirmCheck()">Cevapları Kontrol Et</button>

    <div class="result" id="resultBox" style="display: none;"></div>
  </div>

  <script>
    // Load answer keys from external JSON file
    let answerKeys = {};
    
    fetch('answer_keys.json')
      .then(response => response.json())
      .then(data => {
        answerKeys = data;
        console.log("Answer keys loaded successfully");
      })
      .catch(error => {
        console.error("Error loading answer keys:", error);
        // Fallback to default keys (empty) if file load fails
      });
    
    // Book type display names
    const seriesDisplayNames = {
      tytDenemeleri: "TYT Denemeleri",
      tytAcil: "TYT Acil",
      ozelSeri: "Özel Seri"
    };
    
    // Section question counts
    const sectionCounts = {
      turkce: 40,
      sosyal: 25,
      matematik: 40,
      fen: 20
    };
    
    // Difficulty ratings for each exam (0-8 scale, 0=easiest, 8=hardest)
    const difficultyRatings = {
      ucadimbir: {
        deneme1: 3, // Orta
        deneme2: 4, // Orta-Zor
        deneme3: 5  // Zor
      },
      ucadimiki: {
        deneme1: 2, // Kolay-Orta
        deneme2: 3, // Orta
        deneme3: 4  // Orta-Zor
      },
      ucadimuc: {
        deneme1: 5, // Zor
        deneme2: 6, // Çok Zor
        deneme3: 7  // Yok Artık
      }
    };
    
    // Difficulty text based on the 0-8 scale
    const difficultyTexts = [
      "Çok Kolay",  // 0
      "Kolay",      // 1
      "Kolay-Orta", // 2
      "Orta",       // 3
      "Orta-Zor",   // 4
      "Zor",        // 5
      "Çok Zor",    // 6
      "Yok Artık"   // 7
    ];
    
    // Feedback texts based on percentage ranges with multiple options
    const feedbackTexts = {
      poor: [
        "God does not burden a soul beyond that it can bear. Surah Al-Baqarah 2:286",
        "Indeed, Allah is with those who are patient. Surah Al-Anfal 8:46",
        "He gives strength to the weary and increases the power of the weak. Isaiah 40:29", 
        "A journey of a thousand miles begins with a single step. Lao Tzu",
        "Real knowledge is to know the extent of one's ignorance. Confucius"
      ],
      fair: [
        "Indeed, with hardship [will be] ease. Surah Al-Inshirah 94:6",
        "Do not be deceived: God cannot be mocked. A man reaps what he sows. Galatians 6:7",
        "To make a mistake and not correct it is another mistake. Confucius",
        "The man who moves a mountain begins by carrying away small stones. Confucius"
      ],
      good: [
        "It does not matter how slowly you go as long as you do not stop. Confucius",
        "Our greatest glory is not in never falling, but in rising every time we fall. Confucius",
        "No matter how far you walk, you are as strong as the path you've left behind, and as weak as the road you have yet to walk. Boris Vian"
      ],
      excellent: [
        "If you are thankful, I will give you more. Surah Ibrahim 14:7",
        "helal len"
      ]
    };

    // Variables to store current results
    let currentResults = {
      turkce: { correct: 0, wrong: 0, empty: 0, net: 0 },
      sosyal: { correct: 0, wrong: 0, empty: 0, net: 0 },
      matematik: { correct: 0, wrong: 0, empty: 0, net: 0 },
      fen: { correct: 0, wrong: 0, empty: 0, net: 0 },
      total: { correct: 0, wrong: 0, empty: 0, net: 0, percentage: 0 }
    };
    
    let currentSeriesType = '';
    let currentExamType = '';

    // Check for saved dark mode preference
    function initTheme() {
      const savedTheme = localStorage.getItem('theme') || 'light';
      document.documentElement.setAttribute('data-theme', savedTheme);
      updateDarkModeIcon(savedTheme);
      document.body.classList.toggle('dark-mode', savedTheme === 'dark');
    }

    // Toggle dark mode
    function toggleDarkMode() {
      const currentTheme = document.documentElement.getAttribute('data-theme');
      const newTheme = currentTheme === 'light' ? 'dark' : 'light';
      
      document.documentElement.setAttribute('data-theme', newTheme);
      localStorage.setItem('theme', newTheme);
      
      updateDarkModeIcon(newTheme);
      document.body.classList.toggle('dark-mode', newTheme === 'dark');
    }

    // Update the dark mode toggle icon
    function updateDarkModeIcon(theme) {
      const icon = document.querySelector('#darkModeToggle i');
      if (theme === 'dark') {
        icon.className = 'fas fa-sun';
      } else {
        icon.className = 'fas fa-moon';
      }
    }

    // Update difficulty bar
    function updateDifficultyBar(seriesType, examType) {
      const difficultyContainer = document.getElementById('difficultyContainer');
      
      if (!seriesType || !examType || !difficultyRatings[seriesType] || !difficultyRatings[seriesType][examType]) {
        difficultyContainer.style.display = 'none';
        return;
      }
      
      const difficultyValue = difficultyRatings[seriesType][examType];
      const difficultyText = difficultyTexts[difficultyValue];
      const difficultyPercentage = (difficultyValue / 8) * 100;
      
      document.getElementById('difficultyText').textContent = difficultyText;
      document.getElementById('difficultyMarker').style.left = `${difficultyPercentage}%`;
      
      difficultyContainer.style.display = 'block';
    }

    // Handle tab switching
    function setupTabs() {
      const tabs = document.querySelectorAll('.tab');
      const tabContents = document.querySelectorAll('.tab-content');
      
      tabs.forEach(tab => {
        tab.addEventListener('click', () => {
          // Deactivate all tabs
          tabs.forEach(t => t.classList.remove('active'));
          tabContents.forEach(content => content.classList.remove('active'));
          
          // Activate clicked tab
          tab.classList.add('active');
          const tabName = tab.getAttribute('data-tab');
          document.getElementById(`${tabName}Content`).classList.add('active');
        });
      });
    }

    // Generate form for each section
    function generateSectionForm(sectionId, count) {
      const formContainer = document.getElementById(`${sectionId}Form`);
      formContainer.innerHTML = "";
      
      for (let i = 1; i <= count; i++) {
        const optionRow = document.createElement("div");
        optionRow.className = "option-row";
        
        const optionNum = document.createElement("div");
        optionNum.className = "option-num";
        optionNum.textContent = i;
        
const optionCheckbox = document.createElement("div");
optionCheckbox.className = "option-checkbox";

// First add A, B, C, D, E options
['A', 'B', 'C', 'D', 'E'].forEach(option => {
  const id = `${sectionId}_q${i}_${option}`;
  
  const input = document.createElement("input");
  input.type = "radio";
  input.id = id;
  input.name = `${sectionId}_q${i}`;
  input.value = option;
  input.className = "option-input";
  
  const label = document.createElement("label");
  label.htmlFor = id;
  label.className = "option-label";
  label.textContent = option;
  
  optionCheckbox.appendChild(input);
  optionCheckbox.appendChild(label);
});
        const emptyId = `${sectionId}_q${i}_empty`;
const emptyInput = document.createElement("input");
emptyInput.type = "radio";
emptyInput.id = emptyId;
emptyInput.name = `${sectionId}_q${i}`;
emptyInput.value = "";
emptyInput.className = "option-input";

const emptyLabel = document.createElement("label");
emptyLabel.htmlFor = emptyId;
emptyLabel.className = "option-label empty-label";
emptyLabel.innerHTML = "<small>BOŞ</small>";
optionCheckbox.appendChild(emptyInput);
optionCheckbox.appendChild(emptyLabel);

        optionRow.appendChild(optionNum);
        optionRow.appendChild(optionCheckbox);
formContainer.appendChild(optionRow);
      }
    }

    // Initialize forms for all sections
    function initializeForms() {
      for (const [section, count] of Object.entries(sectionCounts)) {
generateSectionForm(section, count);
      }
    }

    // Update exam type options based on series selection
    function updateExamTypes() {
      const seriesType = document.getElementById('seriesType').value;
      const examTypeSelect = document.getElementById('examType');
      
      examTypeSelect.innerHTML = '<option value="">*Deneme Seçin</option>';
      examTypeSelect.disabled = !seriesType;
      
      if (seriesType) {
for (let i = 1; i <= 3; i++) {
  const option = document.createElement('option');
  option.value = `deneme${i}`;
  option.textContent = `Deneme ${i}`;
  examTypeSelect.appendChild(option);
}
      }
      
      updateDifficultyBar(seriesType, '');
    }

    // Confirm check answers
    function confirmCheck() {
      const seriesType = document.getElementById('seriesType').value;
      const examType = document.getElementById('examType').value;
      
      if (!seriesType || !examType) {
alert('Lütfen seri ve deneme numarasını seçin.');
return;
      }
      
      if (confirm('Cevaplarınızı kontrol etmek istediğinize emin misiniz?')) {
checkAnswers(seriesType, examType);
      }
    }

    // Check answers and calculate results
function checkAnswers(seriesType, examType) {
  const key = answerKeys[seriesType]?.[examType];
  if (!key) {
    alert('Bu deneme için cevap anahtarı bulunamadı.');
    return;
  }

  // Get all radio buttons and reset any previous marking
  document.querySelectorAll('.option-input').forEach(input => {
    input.classList.remove('correct-user', 'wrong');
    input.nextElementSibling.classList.remove('correct-answer');
  });

  // Check each section
  Object.keys(sectionCounts).forEach(section => {
    for (let i = 1; i <= sectionCounts[section]; i++) {
      const userAnswer = document.querySelector(`input[name="${section}_q${i}"]:checked`);
      const correctAnswer = key[section]?.[i];
      
      if (correctAnswer) {
        // Find the correct answer radio button and mark it
        const correctRadio = document.querySelector(`input[name="${section}_q${i}"][value="${correctAnswer}"]`);
        if (correctRadio) {
          correctRadio.nextElementSibling.classList.add('correct-answer');
        }
      }

      if (userAnswer) {
        if (userAnswer.value === correctAnswer) {
          // Correct answer - mark green
          userAnswer.classList.add('correct-user');
        } else if (userAnswer.value !== '') {
          // Wrong answer - mark red
          userAnswer.classList.add('wrong');
        }
      }
    }
  });

      // Reset results
      Object.keys(currentResults).forEach(section => {
currentResults[section] = { correct: 0, wrong: 0, empty: 0, net: 0 };
      });

      // Check each section
      Object.keys(sectionCounts).forEach(section => {
for (let i = 1; i <= sectionCounts[section]; i++) {
  const userAnswer = document.querySelector(`input[name="${section}_q${i}"]:checked`)?.value;
  const correctAnswer = key[section]?.[i];

  if (!userAnswer) {
    currentResults[section].empty++;
  } else if (userAnswer === correctAnswer) {
    currentResults[section].correct++;
  } else {
    currentResults[section].wrong++;
  }
}
currentResults[section].net = currentResults[section].correct - (currentResults[section].wrong * 0.25);
      });

      // Calculate totals
      calculateTotals();
      displayResults();
    }

    // Calculate total results
    function calculateTotals() {
      ['correct', 'wrong', 'empty', 'net'].forEach(metric => {
currentResults.total[metric] = Object.keys(sectionCounts).reduce(
  (sum, section) => sum + currentResults[section][metric], 0
);
      });
      currentResults.total.percentage = (currentResults.total.net / 120) * 100;
    }

    // Display results
    function displayResults() {
      const resultBox = document.getElementById('resultBox');
      resultBox.style.display = 'block';
      
      let html = `
<h3>Sonuçlar</h3>
<div style="overflow-x: auto;">
  <table style="width: 100%; min-width: 300px;">
    <tr>
      <th style="padding: 8px;">Bölüm</th>
      <th style="padding: 8px;">Doğru</th>
      <th style="padding: 8px;">Yanlış</th>
      <th style="padding: 8px;">Boş</th>
      <th style="padding: 8px;">Net</th>
    </tr>`;
      
      Object.entries(currentResults).forEach(([section, results]) => {
        if (section !== 'total') {
          html += `
            <tr>
              <td style="padding: 8px;">${section.charAt(0).toUpperCase() + section.slice(1)}</td>
              <td style="padding: 8px;">${results.correct}</td>
              <td style="padding: 8px;">${results.wrong}</td>
              <td style="padding: 8px;">${results.empty}</td>
              <td style="padding: 8px;">${results.net.toFixed(2)}</td>
            </tr>`;
        }
      });
      
      html += `
        <tr>
          <td style="padding: 8px; font-weight: bold;">Toplam</td>
          <td style="padding: 8px; font-weight: bold;">${currentResults.total.correct}</td>
          <td style="padding: 8px; font-weight: bold;">${currentResults.total.wrong}</td>
          <td style="padding: 8px; font-weight: bold;">${currentResults.total.empty}</td>
          <td style="padding: 8px; font-weight: bold;">${currentResults.total.net.toFixed(2)}</td>
        </tr>
      </table>
    </div>
    <div class="whatsapp-share-container">
      <button class="whatsapp-share-btn" onclick="shareOnWhatsApp()">
        <i class="fab fa-whatsapp"></i> WhatsApp'ta Paylaş
      </button>
    </div>`;

    // Add WhatsApp share function
    function shareOnWhatsApp() {
      const seriesType = document.getElementById('seriesType').value;
      const examType = document.getElementById('examType').value;
      
      // Get series display name
      let seriesName = "";
      if (seriesType === "ucadimbir") seriesName = "3 Adım, 1. Adım";
      else if (seriesType === "ucadimiki") seriesName = "3 Adım, 2. Adım"; 
      else if (seriesType === "ucadimuc") seriesName = "3 Adım, 3. Adım";

      // Get exam number
      const examNumber = examType.replace("deneme", "");
      
      const message = `TYT ${seriesName} - Deneme ${examNumber} Sonuçlarım:
    Türkçe: ${currentResults.turkce.net.toFixed(2)} net
    Sosyal: ${currentResults.sosyal.net.toFixed(2)} net
    Matematik: ${currentResults.matematik.net.toFixed(2)} net  
    Fen: ${currentResults.fen.net.toFixed(2)} net
    Toplam: ${currentResults.total.net.toFixed(2)} net`;

      // Try to use WhatsApp API first
      const whatsappURL = `https://api.whatsapp.com/send?text=${encodeURIComponent(message)}`;
      
      // Fallback to whatsapp:// protocol if API fails
      window.open(whatsappURL, '_blank') || window.location.assign(whatsappURL);
    }
      resultBox.innerHTML = html;
      addFeedback();
    }

    // Add feedback based on performance
    function addFeedback() {
      const percentage = currentResults.total.percentage;
      let feedbackClass, feedbackArray;
      
      if (percentage < 25) {
feedbackClass = 'poor';
feedbackArray = feedbackTexts.poor;
      } else if (percentage < 50) {
feedbackClass = 'fair';
feedbackArray = feedbackTexts.fair;
      } else if (percentage < 75) {
feedbackClass = 'good';
feedbackArray = feedbackTexts.good;
      } else {
feedbackClass = 'excellent';
feedbackArray = feedbackTexts.excellent;
      }
      
      const randomFeedback = feedbackArray[Math.floor(Math.random() * feedbackArray.length)];
      const feedbackDiv = document.createElement('div');
      feedbackDiv.className = `feedback-text feedback-${feedbackClass}`;
      feedbackDiv.textContent = randomFeedback;
      
      document.getElementById('resultBox').appendChild(feedbackDiv);
    }

  function shareOnWhatsApp() {
  const seriesType = document.getElementById('seriesType').value;
  const examType = document.getElementById('examType').value;

  // Get series display name
  let seriesName = "";
  if (seriesType === "ucadimbir") seriesName = "3 Adım, 1. Adım";
  else if (seriesType === "ucadimiki") seriesName = "3 Adım, 2. Adım"; 
  else if (seriesType === "ucadimuc") seriesName = "3 Adım, 3. Adım";

  // Get exam number
  const examNumber = examType.replace("deneme", "");

  // Create share text with emojis
  const shareText = `${seriesName} - Deneme ${examNumber} Sonucum:
✅ Türkçe: ${currentResults.turkce.net.toFixed(2)} net
⚡ Sosyal: ${currentResults.sosyal.net.toFixed(2)} net  
🔢 Matematik: ${currentResults.matematik.net.toFixed(2)} net
🧪 Fen: ${currentResults.fen.net.toFixed(2)} net
📊 Toplam: ${currentResults.total.net.toFixed(2)} net
📈 Yüzde: ${currentResults.total.percentage.toFixed(2)}%
_aopublishing.com.tr_`;

  // Encode text and create WhatsApp URL
  const whatsappURL = `https://api.whatsapp.com/send?text=${encodeURIComponent(shareText)}`;

  // Open WhatsApp share in new window
  window.open(whatsappURL, '_blank');
}


    // Initialize everything
    document.addEventListener('DOMContentLoaded', () => {
      initTheme();
      setupTabs();
      initializeForms();
      document.getElementById('seriesType').addEventListener('change', updateExamTypes);
      document.getElementById('examType').addEventListener('change', () => {
const seriesType = document.getElementById('seriesType').value;
const examType = document.getElementById('examType').value;
updateDifficultyBar(seriesType, examType);
      });
    });
  </script>
</body>
</html>
