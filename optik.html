<!DOCTYPE html>
<html lang="tr">
  
<head>
  <link rel="icon" href="img/favicon.ico" type="image/x-icon">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Optik Form</title>
  <!-- Tom Select CSS -->
<link href="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/css/tom-select.css" rel="stylesheet">

<!-- Tom Select JS -->
<script src="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/js/tom-select.complete.min.js"></script>

<!-- Font Awesome for icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f4f4f4;
      padding: 20px;
    }

    .container {
      max-width: 700px;
      margin: auto;
      background: #fff;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 0 15px rgba(0,0,0,0.1);
    }

    h2 {
      text-align: center;
      margin-bottom: 20px;
    }

    select {
      padding: 10px;
      font-size: 16px;
      border-radius: 8px;
      border: 1px solid #ccc;
      width: 100%;
      margin-bottom: 20px;
    }

    .select-group {
      display: flex;
      gap: 15px;
      margin-bottom: 20px;
    }

    .select-group > div {
      flex: 1;
    }

    .question-row {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
    }

    .question-number {
      width: 35px;
      height: 35px;
      background-color: #a8d5ba;
      color: #fff;
      border-radius: 5px;
      text-align: center;
      line-height: 35px;
      font-weight: bold;
      margin-right: 10px;
    }

    .options {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

/* ÅÄ±klarÄ±n gÃ¶rÃ¼nÃ¼mÃ¼ - eski halin modern hali */
.options input[type="radio"] {
  display: none;
}

.options label {
  display: inline-block;
  width: 35px;
  height: 35px;
  border: 2px solid #ccc;
  border-radius: 50%;
  line-height: 35px;
  text-align: center;
  cursor: pointer;
  transition: all 0.2s ease;
  background-color: white;
  color: black;
}

/* Normal seÃ§ildiÄŸinde */
.options input[type="radio"]:checked + label {
  background-color: #007bff;
  color: white;
  border-color: #007bff;
}

/* KullanÄ±cÄ±nÄ±n doÄŸru iÅŸaretlediÄŸi ÅŸÄ±k: yeÅŸil */
.options input[type="radio"]:checked.correct-user + label {
  background-color: #28a745 !important;
  border-color: #28a745 !important;
  color: white;
}

/* YanlÄ±ÅŸ seÃ§ilen ÅŸÄ±k: kÄ±rmÄ±zÄ± */
.options.wrong input[type="radio"]:checked + label {
  background-color: #dc3545 !important;
  border-color: #dc3545 !important;
  color: white;
}

/* DoÄŸru ÅŸÄ±k ama kullanÄ±cÄ± iÅŸaretlememiÅŸ: sarÄ± */
.options .correct-answer {
  background-color: #ffc107 !important;
  border-color: #ffc107 !important;
  color: black;
}


    .submit-btn {
      background-color: #4CAF50;
      color: white;
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      width: 100%;
      margin-top: 20px;
      cursor: pointer;
      transition: 0.3s;
    }

    .submit-btn:hover {
      background-color: #45a049;
    }

    .result {
      margin-top: 20px;
      font-size: 16px;
    }

    .result table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }

    .result th, .result td {
      border: 1px solid #ccc;
      padding: 10px;
      text-align: center;
    }
    
    .feedback-text {
      margin-top: 15px;
      padding: 15px;
      border-radius: 8px;
      text-align: center;
      font-weight: 500;
      font-style: italic;
    }
    
    .feedback-poor {
      background-color: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
    
    .feedback-fair {
      background-color: #fff3cd;
      color: #856404;
      border: 1px solid #ffeeba;
    }
    
    .feedback-good {
      background-color: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }
    
    .feedback-excellent {
      background-color: #cce5ff;
      color: #004085;
      border: 1px solid #b8daff;
    }

    /* Whatsapp share button styles */
    .whatsapp-share-btn {
      background-color: #25D366;
      color: white;
      padding: 10px 15px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      margin: 15px auto;
      transition: all 0.3s ease;
    }

    .whatsapp-share-btn:hover {
      background-color: #128C7E;
    }

    .whatsapp-share-container {
      text-align: center;
      margin-top: 15px;
    }

    @media (max-width: 600px) {
      .select-group {
        flex-direction: column;
      }
      
      .question-row {
        flex-direction: column;
        align-items: flex-start;
      }

      .options {
        margin-top: 5px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div style="text-align: center; margin-bottom: 20px;">
      <a href="index.html">
        <img src="img/logoBf.png" alt="Site Logo" style="max-width: 150px; height: auto;">
      </a>
    </div>
    <h2>Optik Form</h2>
    <div style="background-color: #f8f9fa; color: #6c757d; padding: 15px; border-radius: 8px; text-align: center; margin-bottom: 20px; font-size: 14px; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);">
      Bu form, sÄ±nav sonuÃ§larÄ±nÄ±zÄ± kontrol etmek iÃ§in kullanÄ±lmaktadÄ±r. LÃ¼tfen sÄ±nav tÃ¼rÃ¼nÃ¼ seÃ§in ve ardÄ±ndan cevaplarÄ±nÄ±zÄ± iÅŸaretleyin. CevaplarÄ± ezberleyip denemeyi Ã§Ã¶zmek bir ÅŸey anlamanÄ±za katkÄ±da bulunmayacaktÄ±r. Sadece kendinizi kandÄ±rmÄ±ÅŸ olursunuz.
    </div>

    <div style="background-color: #f8f9fa; color: #6c757d; padding: 15px; border-radius: 8px; text-align: center; margin-bottom: 20px; font-size: 14px; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);">
    <em>"Anlamak istemeyene hiÃ§bir ÅŸey Ã¶ÄŸretemem ben."</em> <br> <strong><em>KonfÃ¼Ã§yÃ¼s</em></strong>
    </div>
    
    <div class="select-group">
      <div>
        <select id="bookType">
          <option value="">*Kitap SeÃ§in</option>
          <option value="hissetmek">YDT'yi Hissetmek</option>
          <option value="anlamak">YDT'yi Anlamak</option>
          <option value="anlamamak">YDT'yi Anlamamak</option>
          <option value="usenmek">YDT'ye ÃœÅŸenmek</option>
        </select>
      </div>
      <div>
        <select id="testType" disabled>
          <option value="">*Test SeÃ§in</option>
        </select>
      </div>
    </div>

    <div id="optikForm"></div>

    <button class="submit-btn" onclick="confirmCheck()">CevaplarÄ± Kontrol Et</button>

    <div class="result" id="resultBox" style="display: none;"></div>
  </div>

  <script>
    const answerKeys = {
      hissetmek: {
        test1: ['A', 'C', 'B', 'D', 'E', 'A', 'B', 'C', 'D', 'E'],
        test2: ['B', 'A', 'C', 'D', 'E', 'A', 'B', 'C', 'D', 'E']
      },
      anlamak: {
        test1: ['A', 'D', 'D', 'A', 'C', 'D', 'D', 'A', 'E', 'D', 'E', 'E', 'D', 'C', 'E', 'A', 'D', 'C', 'B', 'D', 'C', 'B', 'C', 'A', 'C', 'E', 'D', 'C', 'E', 'B', 'D', 'A', 'B', 'B', 'E', 'E', 'D', 'C', 'A', 'A', 'D', 'E', 'B', 'A', 'B', 'E', 'A', 'C', 'A', 'A', 'B', 'D', 'C', 'E', 'A', 'E', 'D', 'D', 'E', 'D'],
        test2: ['A', 'B', 'C', 'D', 'E', 'A', 'B', 'C', 'D', 'E']
      },
      anlamamak: {
        test1: ['A', 'C', 'B', 'D', 'E'],
        test2: ['B', 'D', 'A', 'C', 'E']
      },
      usenmek: {
        test1: ['C', 'C', 'E', 'B', 'D', 'D', 'B', 'A', 'A', 'E', 'C', 'C', 'D', 'B', 'B', 'E', 'A', 'A', 'B', 'E', 'D', 'C', 'E', 'C'],
        test2: ['A', 'B', 'C', 'D', 'E', 'A', 'B', 'C', 'D', 'E', 'A', 'B', 'C', 'D', 'E']
      }
    };
    
    // Book type display names
    const bookDisplayNames = {
      hissetmek: "YDT'yi Hissetmek",
      anlamak: "YDT'yi Anlamak",
      anlamamak: "YDT'yi Anlamamak",
      usenmek: "YDT'ye ÃœÅŸenmek"
    };
    
    // Feedback texts based on percentage ranges with multiple options
    const feedbackTexts = {
      poor: [
        "God does not burden a soul beyond that it can bear. Surah Al-Baqarah 2:286",
        "Indeed, Allah is with those who are patient. Surah Al-Anfal 8:46",
        "He gives strength to the weary and increases the power of the weak. Isaiah 40:29", 
        "A journey of a thousand miles begins with a single step. Lao Tzu",
        "Real knowledge is to know the extent of one's ignorance. Confucius"
          ],
      fair: [
        "Indeed, with hardship [will be] ease. Surah Al-Inshirah 94:6",
        "Do not be deceived: God cannot be mocked. A man reaps what he sows. Galatians 6:7",
        "To make a mistake and not correct it is another mistake. Confucius",
        "The man who moves a mountain begins by carrying away small stones. Confucius"
      ],
      good: [
        "It does not matter how slowly you go as long as you do not stop. Confucius",
        "Our greatest glory is not in never falling, but in rising every time we fall. Confucius",
        "No matter how far you walk, you are as strong as the path you've left behind, and as weak as the road you have yet to walk. Boris Vian"
      ],
      excellent: [
        "If you are thankful, I will give you more. Surah Ibrahim 14:7",
        "helal len"
      ]
    };

    // Variables to store current results
    let currentCorrect = 0;
    let currentWrong = 0;
    let currentEmpty = 0;
    let currentNet = 0;
    let currentPercentage = 0;
    let currentBookType = '';
    let currentTestType = '';

    // Tom Select initialization
    const bookSelect = new TomSelect('#bookType', {
      create: false,
      sortField: {
        field: "text",
        direction: "asc"
      },
      placeholder: "Kitap SeÃ§in...",
      allowEmptyOption: true,
      onChange: function(value) {
        updateTests(value);
      }
    });

    const testSelect = new TomSelect('#testType', {
      create: false,
      placeholder: "Test SeÃ§in...",
      allowEmptyOption: true,
      onChange: function(value) {
        generateForm();
      }
    });

    function updateTests(bookType) {
      const testSelectEl = document.getElementById("testType");
      
      // Clear existing options
      testSelect.clearOptions();
      testSelect.addOption({value: '', text: '*Test SeÃ§in'});
      
      if (!bookType) {
        testSelect.disable();
        return;
      }
      
      // Add test options for the selected book
      const tests = answerKeys[bookType];
      Object.keys(tests).forEach(testKey => {
        const testNumber = testKey.replace('test', '');
        testSelect.addOption({
          value: testKey,
          text: `Test ${testNumber}`
        });
      });
      
      testSelect.enable();
      testSelectEl.removeAttribute("disabled");
      testSelect.clear();
    }

    function generateForm() {
      const bookType = bookSelect.getValue();
      const testType = testSelect.getValue();
      const formContainer = document.getElementById("optikForm");
      formContainer.innerHTML = "";
      
      if (!bookType || !testType) return;

      const correctAnswers = answerKeys[bookType][testType];
      const total = correctAnswers.length;

      for (let i = 1; i <= total; i++) {
        const row = document.createElement("div");
        row.className = "question-row";

        const number = document.createElement("div");
        number.className = "question-number";
        number.textContent = i;

        const options = document.createElement("div");
        options.className = "options";
        options.setAttribute("data-question", i);

        ['A', 'B', 'C', 'D', 'E', 'BOÅ'].forEach(option => {
          const id = `q${i}_${option}`;
          const input = document.createElement("input");
          input.type = "radio";
          input.id = id;
          input.name = `q${i}`;
          input.value = option;

          const label = document.createElement("label");
          label.htmlFor = id;
          label.textContent = option;

          options.appendChild(input);
          options.appendChild(label);
        });

        row.appendChild(number);
        row.appendChild(options);
        formContainer.appendChild(row);
      }

      document.getElementById("resultBox").style.display = "none";
    }

    function confirmCheck() {
      if (confirm("CevaplarÄ± kontrol etmek istediÄŸinize emin misiniz?")) {
        checkAnswers();
      }
    }

    function checkAnswers() {
      const bookType = bookSelect.getValue();
      const testType = testSelect.getValue();
      
      if (!bookType || !testType) return alert("LÃ¼tfen kitap ve test tÃ¼rÃ¼nÃ¼ seÃ§in!");
      
      const correctAnswers = answerKeys[bookType][testType];
      if (!correctAnswers) return alert("LÃ¼tfen test tÃ¼rÃ¼nÃ¼ seÃ§in!");

      let correct = 0, wrong = 0, empty = 0;

      document.querySelectorAll(".options").forEach(optionGroup => {
        const qNumber = parseInt(optionGroup.getAttribute("data-question"));
        const selected = optionGroup.querySelector("input:checked");
        const correctAnswer = correctAnswers[qNumber - 1];
        optionGroup.classList.remove("wrong");

        const labels = optionGroup.querySelectorAll("label");
        labels.forEach(label => {
          label.classList.remove("correct-answer");
        });

        if (!selected || selected.value === "BOÅ") {
          empty++;
        } else if (selected.value === correctAnswer) {
          correct++;
          selected.classList.add("correct-user");
        } else {
          wrong++;
          optionGroup.classList.add("wrong");
          labels.forEach(label => {
            if (label.textContent === correctAnswer) {
              label.classList.add("correct-answer");
            }
          });
        }
      });

      const net = correct - (wrong / 4);
      const totalQuestions = correctAnswers.length;
      const percentage = (net / totalQuestions) * 100;
      
      // Save current results for sharing
      currentCorrect = correct;
      currentWrong = wrong;
      currentEmpty = empty;
      currentNet = net;
      currentPercentage = percentage;
      currentBookType = bookType;
      currentTestType = testType;
      
      // Determine feedback type based on percentage
      let feedbackType, feedbackClass;
      if (percentage >= 0 && percentage < 30) {
        feedbackType = 'poor';
        feedbackClass = 'feedback-poor';
      } else if (percentage >= 30 && percentage < 50) {
        feedbackType = 'fair';
        feedbackClass = 'feedback-fair';
      } else if (percentage >= 50 && percentage < 75) {
        feedbackType = 'good';
        feedbackClass = 'feedback-good';
      } else {
        feedbackType = 'excellent';
        feedbackClass = 'feedback-excellent';
      }
      
      // Select a random feedback message from the appropriate category
      const feedbackMessages = feedbackTexts[feedbackType];
      const randomIndex = Math.floor(Math.random() * feedbackMessages.length);
      const selectedFeedback = feedbackMessages[randomIndex];
      
      const resultBox = document.getElementById("resultBox");
      resultBox.innerHTML = `
        <table>
          <tr>
            <th>DoÄŸru</th>
            <th>YanlÄ±ÅŸ</th>
            <th>BoÅŸ</th>
            <th>Net</th>
            <th>YÃ¼zde</th>
          </tr>
          <tr>
            <td>${correct}</td>
            <td>${wrong}</td>
            <td>${empty}</td>
            <td>${net.toFixed(2)}</td>
            <td>${percentage.toFixed(2)}%</td>
          </tr>
        </table>
        <div class="feedback-text ${feedbackClass}">
          ${selectedFeedback}
        </div>
        <div class="whatsapp-share-container">
          <button class="whatsapp-share-btn" onclick="shareResultsOnWhatsApp()">
            <i class="fab fa-whatsapp"></i> WhatsApp'ta PaylaÅŸ
          </button>
        </div>
      `;
      resultBox.style.display = "block";
    }

    function shareResultsOnWhatsApp() {
      // Get the book display name
      const bookDisplayName = bookDisplayNames[currentBookType];
      const testNumber = currentTestType.replace('test', '');
      
      // Create share text
      const shareText = `${bookDisplayName} - Test ${testNumber} Sonucum:
âœ… DoÄŸru: ${currentCorrect}
âŒ YanlÄ±ÅŸ: ${currentWrong}
â– BoÅŸ: ${currentEmpty}
ğŸ“Š Net: ${currentNet.toFixed(2)}
ğŸ“ˆ YÃ¼zde: ${currentPercentage.toFixed(2)}%
_www.aopublishing.com.tr_`;
      
      // Encode the text for URL
      const encodedText = encodeURIComponent(shareText);
      
      // Create WhatsApp share URL
      const whatsappURL = `https://api.whatsapp.com/send?text=${encodedText}`;
      
      // Open WhatsApp share in a new window
      window.open(whatsappURL, '_blank');
    }

  </script>
</body>
</html>